<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Map</title>
        <meta charset="utf-5"/>


        <!------------------------------------------------------------------------------>
        <!-- Bootstrap for Mobile-first                                               -->
        <!------------------------------------------------------------------------------>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

        <!------------------------------------------------------------------------------>
        <!-- Add Firebase products that you want to use                               -->
        <!------------------------------------------------------------------------------>
        <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-firestore.js"></script>
        <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
        <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />

        <!------------------------------------------------------------------------------>
        <!-- Optional styles and scripts of your own                                  -->
        <!------------------------------------------------------------------------------>
        <link rel="stylesheet" href="Style/JackStyle.css">
        <script src="scripts/script.js"></script>

        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
              integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
              crossorigin=""/>

        <!-- Make sure you put this AFTER Leaflet's CSS -->
        <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
                integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
                crossorigin=""></script>

        <style>
           
        </style>


        <script>
            // Your web app's Firebase configuration
            var firebaseConfig = {
                apiKey: "AIzaSyBdBMvmyQQvDUE7yQK8kypXmL8Xko7SJhw",
                authDomain: "studybuddy-ce7e9.firebaseapp.com",
                databaseURL: "https://studybuddy-ce7e9.firebaseio.com",
                projectId: "studybuddy-ce7e9",
                storageBucket: "studybuddy-ce7e9.appspot.com",
                messagingSenderId: "288586368350",
                appId: "1:288586368350:web:c13d8a08c9249b15cbbbcf",
                measurementId: "G-VYXB59FGNZ"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);

            var db = firebase.firestore();
        </script>

    </head>
    <body>

        <Script>
            var citiesRef = db.collection("cities123");

            citiesRef.doc("SF").set({
                name: "San Francisco", state: "CA", country: "USA",
                capital: false, population: 860000,
                regions: ["west_coast", "norcal"] });
            citiesRef.doc("LA").set({
                name: "Los Angeles", state: "CA", country: "USA",
                capital: false, population: 3900000,
                regions: ["west_coast", "socal"] });
            citiesRef.doc("DC").set({
                name: "Washington, D.C.", state: null, country: "USA",
                capital: true, population: 680000,
                regions: ["east_coast"] });
            citiesRef.doc("TOK").set({
                name: "Tokyo", state: null, country: "Japan",
                capital: true, population: 9000000,
                regions: ["kanto", "honshu"] });
            citiesRef.doc("BJ").set({
                name: "Beijing", state: null, country: "China",
                capital: true, population: 21500000,
                regions: ["jingjinji", "hebei"] });
            citiesRef.doc("BJqwdw").set({
                name: "Beijing", state: null, country: "China",
                capital: true, population: 21500000,
                regions: ["jingjinji", "hebei"] });

        </Script>
        <div id='content'>
            <div id="mapid"></div>

            <div id="detailsOfGroups">
                <div id="heading">
                    <div id="info1"></div>
                    <span id="info2"></span>
                    <span id="info3"></span>
                    <div id="author"></div>
                </div>
                <div id="details">
                    <div id='textDetails'></div>
                    <div id='joinButton'><img src='Images/Icon/Join.png' width='60px'></div>
                </div>
            </div>
        </div>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

        <script>
            /* Cordinates--------------------------------
            SW1:[49.250853, -123.002758]
            SW2:[49.250278, -123.00337]
            SW3:[49.249935, -123.002576]
            SW5:[49.249697, -123.002586]
            SW9:[49.248675, -123.002801]

            NW1:[49.252866, -123.003343
            NW3:[49.253307, -123.002651]
            NW6:[49.252162, -123.002431]

            NE1: [49.254014, -123.000988]
            NE4:[49.253367, -123.001063]
            NE8:[49.253391, -122.999218]
            NE9:[49.254221, -122.998708]
            NE10:[49.253346, -122.998477]
            NE12:[49.252775, -122.998493]
            NE16:[49.252124, -122.999743]
            NE18:[49.252124, -123.000725]
            NE20:[49.252155, -123.001503]

            SE1:[49.251266, -122.999142]
            SE2:[49.251434, -123.001143]
            SE6:[49.250923, -123.000398]
            SE8:[49.250842, -123.001379]
            SE10:[49.24989, -123.000661]
            SE12:[49.25018, -123.001519]
            SE14:[49.24949, -123.000677]
            -----------------------------------------------------*/


            var mymap = L.map('mapid').setView([49.2500, -123.0000], 17);

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,
                id: 'mapbox.streets',
                accessToken: 'pk.eyJ1IjoicHlvcG9seSIsImEiOiJjazJrdGhpc3owem8wM2VsYWk0cWs4eGFyIn0.FnpymVeZSR-Pif_eaOMI6w'
            }).addTo(mymap);


            L.marker([49.249697, -123.002586]).addTo(mymap)
                .bindPopup('Comp1510<br>"Cram for Finals!!"<br><a href="http://www.bcit.ca">Join This Group</a>')
                .openPopup();

            var popup = L.popup();


            var myIcon = L.icon({
                iconUrl: 'images/icon/orange icon.png',
                iconSize:     [40,45 ], // size of the icon
                iconAnchor:   [22, 40], // point of the icon which will correspond to marker's location
                popupAnchor:  [-3, -60] // point from which the popup should open relative to the iconAnchor
            });


            var join = '<img id =join src=images/icon/join.png float=right>';

            //function I made
            function courseName(name) {
                var course = '<span id="course">' + name + ' </span>';
                return course;
            }

            function groupName(name) {
                var group = '<span id="groupName">' + name + ' </span>';
                return group;
            }

            function createGroup(groupNumber, course, nameOfGroup) {
                var group = '<div id="group' + groupNumber + '">' + courseName(course) + groupName(nameOfGroup) + join + '</div>';
                return group;
            }

            //Example: var group = '<div class="group1">' + courseName('comp1510') + groupName('Finals Sprint') + join + '</div>';
            var group1 = createGroup(1, 'Comp1510', "Let's study");
            var group2 = createGroup(2, 'Comp1712', "Finals Sprint");
            var group3 = createGroup(3, 'comp1113', "Paul's group");
            var group4 = createGroup(4, 'comm1116', "Report Discussion");
            var group5 = createGroup(5, 'comp1712', "HELP!!!");
            var group6 = createGroup(6, 'comp1536', "lab7");
            var group7 = createGroup(7, 'comp1113', "Boolean Algebra");
            var group8 = createGroup(8, 'comm1116', "Presentation");

            //------------------------------The pins on the map--------------------------
            //SE2
            L.marker([49.251434, -123.001143], {icon: myIcon}).addTo(mymap)
                .bindPopup('<div id="iconPopup">' + group1 + group2 + group3 + '</div>')
                .openPopup();;

            //SW1
            L.marker([49.250853, -123.002758], {icon: myIcon}).addTo(mymap)
                .bindPopup('<div id="iconPopup">' + group4 + group5 + group6 + group7 + group8 + '</div>')
                .openPopup();;
            //------------------------------------------------------------------------------------------


            //tells the longitute and latitue----------------------------
            function onMapClick(e) {
                popup
                    .setLatLng(e.latlng)
                    .setContent("You clicked the map at " + e.latlng.toString())
                    .openOn(mymap);
            }

            //--------------The Join Group Details popup window ----------------------------
            $(document).ready(function() {
                $(document).on('click', '#group1', function(){
                    var courseName = document.getElementById("group1").childNodes[0].cloneNode(true);
                    var groupName = document.getElementById("group1").childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html(" Created by: Jason");
                    $('#textDetails').html("Meet me in SE2 403!");
                    mymap.on('click', onMapClick);
                });
            });


            $(document).ready(function() {
                $(document).on('click', '#group2', function(){
                    var courseName = document.getElementById("group2").childNodes[0].cloneNode(true);
                    var groupName = document.getElementById("group2").childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html(" Created by: Sandy");
                    $('#textDetails').html("@SE2 304 computer lab, join me!");
                    mymap.on('click', onMapClick);
                });
            });

            $(document).ready(function() {
                $(document).on('click', '#group3', function(){
                    var courseName = document.getElementById("group3").childNodes[0].cloneNode(true);
                    var groupName = document.getElementById("group3").childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html(" Created by: Anna");
                    $('#textDetails').html("SE2 224. Let's study!");
                    mymap.on('click', onMapClick);
                });
            });


            $(document).ready(function() {
                $(document).on('click', '#group4', function(){
                    var courseName = document.getElementById("group4").childNodes[0].cloneNode(true);
                    var groupName = document.getElementById("group4").childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html(" Created by: Sora");
                    $('#textDetails').html("SW1 412. I have cookies!");
                    mymap.on('click', onMapClick);
                });
            });

            $(document).ready(function() {
                $(document).on('click', '#group5', function(){
                    var courseName = document.getElementById("group5").childNodes[0].cloneNode(true);
                    var groupName = document.getElementById("group5").childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html("Created by: James");
                    $('#textDetails').html("SW1 303 See you soon!");
                    mymap.on('click', onMapClick);
                });
            });


            $(document).ready(function() {
                $(document).on('click', '#group6', function(){
                    var courseName = document.getElementById('group6').childNodes[0].cloneNode(true);
                    var groupName = document.getElementById('group6').childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html("Created by: Lucy");
                    $('#textDetails').html("SW1 202. I am lonely :(");
                    mymap.on('click', onMapClick);
                });
            });

            $(document).ready(function() {
                $(document).on('click', '#group7', function(){
                    var courseName = document.getElementById('group6').childNodes[0].cloneNode(true);
                    var groupName = document.getElementById('group6').childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html("Created by: David");
                    $('#textDetails').html("SW1 354. I need friends!");
                    mymap.on('click', onMapClick);
                });
            });

            $(document).ready(function() {
                $(document).on('click', '#group8', function(){
                    var courseName = document.getElementById('group8').childNodes[0].cloneNode(true);
                    var groupName = document.getElementById('group8').childNodes[1].cloneNode(true);
                    $('#info2').html(courseName);
                    $('#info3').html(groupName);
                    $('#author').html("Created by: Ken");
                    $('#textDetails').html("SW1 322. Going to study till 5pm");
                    mymap.on('click', onMapClick);
                });
            });




            /*****-----------------------The join group popup toggle on and off---------------------***/
            $(document).ready(function() {
                $(document).on('click', 'div[id^=group]', function(){
                    $('#detailsOfGroups').show(200);
                    $('#detailsOfGroups').css({
                        'z-index': '1',
                        'position' : 'absolute'
                    });
                    $('#info1').html("<span id='close'>close</span>");
                    $('#mapid').css({
                        'z-index': '-2',
                    });
                });
            });

            $(document).ready(function() {
                $(document).on('click', '#close', function(){
                    $('#detailsOfGroups').hide(200);
                    $('#mapid').css({
                        'z-index': '2'
                    });
                });
            });
        </script>

    </body>
</html>